package main

import (
	"./web"
	"./admin"
	"net/http"
	"./admin/ueditor"
	"./common"
	"fmt"
)


func main() {
	//var success = common.LexemeCreate(2,1,`<div class="content"><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><span style="-webkit-tap-highlight-color: transparent; box-sizing: border-box; font-weight: 700; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">一、概述</span></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">使用Java技术构建Web应用时， 我们通常离不开tomcat和jetty之类的servlet容器，这些Web服务器功能强大，性能强劲，深受欢迎，是运行大型Web应用的必备神器。</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">虽然Java的设计初衷就是用来开发大型应用的，然而有时候我们开发的程序只是简单的小型应用，对于功能的需求和性能的要求并不高， 可能仅仅就几百行甚至几十行代码，这个时候使用tomcat之类的Web服务器去运行就显得有点大材小用了。 比如说只是将数据库中的数据读出来转换成JSON，以Web服务的形式吐给调用方这样的阉割型Web应用。 如下图所示</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="white-space: normal;"><img src="https://www.chhblog.com/static/upload/ac30d99dfb8211e7ae6200163e0233f7.png" title="" alt="}HAF8X7MZPZ@AJQGR_M2F}1.png" style="cursor: pointer;"></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><span style="-webkit-tap-highlight-color: transparent; box-sizing: border-box; font-weight: 700;"><br></span></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><span style="-webkit-tap-highlight-color: transparent; box-sizing: border-box; font-weight: 700;">二、最简单的Java Http服务器</span></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">其实在jdk中已经内置了用于此类简单Web应用构建需求的类库了，sun公司提供的 com.sun.net.httpserver 包就是用来帮助我们解决这类问题的</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><img src="https://www.chhblog.com/static/upload/b9f85c11fb8211e7ae6200163e0233f7.png" title="" alt="~61XXY[_]_K@QQJPG10[SG.png" style="cursor: pointer;"></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">如上代码清单所示， 仅仅几行代码就可以构建一个五脏俱全的Web应用了。执行代码，在浏览器地址栏里代开链接</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">http://localhost:8001/test</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">就能运行这个段程序，输入的结果为helloworld</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><span style="-webkit-tap-highlight-color: transparent; box-sizing: border-box; font-weight: 700;">三、获得外部数据</span></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">那在这个程序中如何获取到外部传递过来的数据呢？比如说URL上的查询字符串，POST提交的数据等，其实也很简单</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="white-space: normal;"><img src="https://www.chhblog.com/static/upload/c0e729e3fb8211e7ae6200163e0233f7.png" title="" alt="7T]Z3_DDF2V32N]M}E{)90.png" style="cursor: pointer;"></p><p style="white-space: normal;"><br></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">上面的代码清单标识了实现的方法。</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">注意，要保证上面代码编译通过， 需要引入commons-io.jar，此包中提供将InputStream转换成String的方法。</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><br></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);"><span style="-webkit-tap-highlight-color: transparent; box-sizing: border-box; font-weight: 700;">四、优点</span></p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">Java内置Web服务器在功能、性能、稳定等方面是无法和tomcat和jetty之类的专业Web服务器相比的， 它的优点主要是开发和部署方便简单， 把程序代码编译成jar包后，丢到装有jvm的服务器上， 直接运行就可以了，省去了安装相关的软件、依赖， 配置复杂的环境等工作量。</p><p style="margin-top: 16px; margin-bottom: 16px; white-space: normal; -webkit-tap-highlight-color: transparent; box-sizing: border-box; padding: 0px; color: rgb(34, 34, 34); font-family: &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(255, 255, 255);">但是， 在一些各方面要求都比较高的生产环境下，还是建议使用专门的Web服务器，毕竟它们久经考验，能满足所有功能需求，并且出问题的几率低。</p><p><br></p> </div>`)
	//fmt.Println(success)
	var dataCount, dataList = common.LexemeFind("陈大侠",1,1,20)
	fmt.Println(dataCount)
	fmt.Println(dataList)

	//前端
	http.Handle("/log/", http.FileServer(http.Dir(".")))
	http.Handle("/html/", http.FileServer(http.Dir(".")))
	http.Handle("/upload/", http.FileServer(http.Dir(".")))
	http.Handle("/ueditor/", http.FileServer(http.Dir(".")))
	http.Handle("/", new(web.Index));
	http.Handle("/index", new(web.Index));
	http.Handle("/article_view", new(web.ArticleView));

	//后端
	http.HandleFunc("/admin/login", admin.Login );
	http.HandleFunc("/admin/logout", admin.Logout );
	http.HandleFunc("/admin/check_login", admin.CheckLogin )
	http.HandleFunc("/admin/article_list", admin.ArticleList)
	http.HandleFunc("/admin/article_add", admin.ArticleAdd)
	http.HandleFunc("/admin/article_del", admin.ArticleDel)
	http.HandleFunc("/admin/article_cates", admin.ArticleCates)
	http.HandleFunc("/admin/article_view", admin.ArticleView)
	http.HandleFunc("/admin/article_edit", admin.ArticleEdit)

	http.HandleFunc("/get_ip_info", web.GetIpInfo)

	//UEditor上传图片
	http.HandleFunc("/ueditor/go/controller", ueditor.Controller)
	http.Handle("/static/", http.FileServer(http.Dir(".")))

	http.ListenAndServe(":9529", nil);
}

